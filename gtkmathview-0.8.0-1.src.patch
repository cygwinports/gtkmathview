diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x aclocal.m4 -x Makefile.in -x configure -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in origsrc/gtkmathview-0.8.0/acinclude.m4 src/gtkmathview-0.8.0/acinclude.m4
--- origsrc/gtkmathview-0.8.0/acinclude.m4	1969-12-31 18:00:00.000000000 -0600
+++ src/gtkmathview-0.8.0/acinclude.m4	2008-07-01 12:23:10.968750000 -0500
@@ -0,0 +1,78 @@
+# Check for binary relocation support
+# Hongli Lai
+# http://autopackage.org/
+
+AC_DEFUN([AM_BINRELOC],
+[
+	AC_ARG_ENABLE(binreloc,
+		[  --enable-binreloc       compile with binary relocation support
+                          (default=disable)],
+		enable_binreloc=$enableval,enable_binreloc=no)
+
+	AC_ARG_ENABLE(binreloc-threads,
+		[  --enable-binreloc-threads      compile binary relocation with threads support
+	                         (default=yes)],
+		enable_binreloc_threads=$enableval,enable_binreloc_threads=yes)
+
+	BINRELOC_CFLAGS=
+	BINRELOC_LIBS=
+	if test "x$enable_binreloc" = "xauto"; then
+		AC_CHECK_FILE([/proc/self/maps])
+		AC_CACHE_CHECK([whether everything is installed to the same prefix],
+			       [br_cv_valid_prefixes], [
+				if test "$bindir" = '${exec_prefix}/bin' -a "$sbindir" = '${exec_prefix}/sbin' -a \
+					"$datadir" = '${prefix}/share' -a "$libdir" = '${exec_prefix}/lib' -a \
+					"$libexecdir" = '${exec_prefix}/libexec' -a "$sysconfdir" = '${prefix}/etc'
+				then
+					br_cv_valid_prefixes=yes
+				else
+					br_cv_valid_prefixes=no
+				fi
+				])
+	fi
+	AC_CACHE_CHECK([whether binary relocation support should be enabled],
+		       [br_cv_binreloc],
+		       [if test "x$enable_binreloc" = "xyes"; then
+		       	       br_cv_binreloc=yes
+		       elif test "x$enable_binreloc" = "xauto"; then
+			       if test "x$br_cv_valid_prefixes" = "xyes" -a \
+			       	       "x$ac_cv_file__proc_self_maps" = "xyes"; then
+				       br_cv_binreloc=yes
+			       else
+				       br_cv_binreloc=no
+			       fi
+		       else
+			       br_cv_binreloc=no
+		       fi])
+
+	if test "x$br_cv_binreloc" = "xyes"; then
+		BINRELOC_CFLAGS="-DENABLE_BINRELOC"
+		AC_DEFINE(ENABLE_BINRELOC,,[Use binary relocation?])
+		if test "x$enable_binreloc_threads" = "xyes"; then
+			AC_CHECK_LIB([pthread], [pthread_getspecific])
+		fi
+
+		AC_CACHE_CHECK([whether binary relocation should use threads],
+			       [br_cv_binreloc_threads],
+			       [if test "x$enable_binreloc_threads" = "xyes"; then
+					if test "x$ac_cv_lib_pthread_pthread_getspecific" = "xyes"; then
+						br_cv_binreloc_threads=yes
+					else
+						br_cv_binreloc_threads=no
+					fi
+			        else
+					br_cv_binreloc_threads=no
+				fi])
+
+		if test "x$br_cv_binreloc_threads" = "xyes"; then
+			BINRELOC_LIBS="-lpthread"
+			AC_DEFINE(BR_PTHREAD,1,[Include pthread support for binary relocation?])
+		else
+			BINRELOC_CFLAGS="$BINRELOC_CFLAGS -DBR_PTHREADS=0"
+			AC_DEFINE(BR_PTHREAD,0,[Include pthread support for binary relocation?])
+		fi
+	fi
+	AC_SUBST(BINRELOC_CFLAGS)
+	AC_SUBST(BINRELOC_LIBS)
+])
+
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x aclocal.m4 -x Makefile.in -x configure -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in origsrc/gtkmathview-0.8.0/auto/Makefile.am src/gtkmathview-0.8.0/auto/Makefile.am
--- origsrc/gtkmathview-0.8.0/auto/Makefile.am	2007-10-15 03:55:33.000000000 -0500
+++ src/gtkmathview-0.8.0/auto/Makefile.am	2008-07-01 14:13:38.140625000 -0500
@@ -5,7 +5,7 @@
 if COND_GMETADOM
 noinst_PROGRAMS += dumpEntitiesTable
 
-entitiesTable.inc: $(CONFIGDIR)/entities-table.xml dumpEntitiesTable
+entitiesTable.inc: $(CONFIGDIR)/entities-table.xml dumpEntitiesTable$(EXEEXT)
 	./dumpEntitiesTable $< >$@
 
 else
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x aclocal.m4 -x Makefile.in -x configure -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in origsrc/gtkmathview-0.8.0/config/gtkmathview.conf.xml.in src/gtkmathview-0.8.0/config/gtkmathview.conf.xml.in
--- origsrc/gtkmathview-0.8.0/config/gtkmathview.conf.xml.in	2007-08-17 05:02:47.000000000 -0500
+++ src/gtkmathview-0.8.0/config/gtkmathview.conf.xml.in	2008-07-01 12:23:11.000000000 -0500
@@ -87,7 +87,7 @@
       <key name="priority">1</key>
     </section>
     <section name="pango-computer-modern-shaper">
-      <key name="enabled">false</key>
+      <key name="enabled">true</key>
       <key name="priority">1</key>
       <key name="post-shaping">always</key>
     </section>
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x aclocal.m4 -x Makefile.in -x configure -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in origsrc/gtkmathview-0.8.0/src/Makefile.am src/gtkmathview-0.8.0/src/Makefile.am
--- origsrc/gtkmathview-0.8.0/src/Makefile.am	2007-04-25 03:14:46.000000000 -0500
+++ src/gtkmathview-0.8.0/src/Makefile.am	2008-07-01 12:23:11.015625000 -0500
@@ -7,7 +7,7 @@
 MAYBE_GTK_SUBDIRS = $(NULL)
 endif
 
-SUBDIRS = common engine backend frontend . view $(MAYBE_GTK_SUBDIRS)
+SUBDIRS = common engine frontend . backend view $(MAYBE_GTK_SUBDIRS)
 
 if COND_BOXML
 MAYBE_BOXML_LIBADD = \
@@ -34,3 +34,6 @@
   $(top_builddir)/src/common/libcommon.la \
   -lstdc++ \
   $(NULL)
+
+$(top_builddir)/src/backend/common/libbackend_common.la:
+	cd $(@D); $(MAKE)
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x aclocal.m4 -x Makefile.in -x configure -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in origsrc/gtkmathview-0.8.0/src/backend/gtk/Makefile.am src/gtkmathview-0.8.0/src/backend/gtk/Makefile.am
--- origsrc/gtkmathview-0.8.0/src/backend/gtk/Makefile.am	2007-08-17 05:02:42.000000000 -0500
+++ src/gtkmathview-0.8.0/src/backend/gtk/Makefile.am	2008-07-01 12:23:11.468750000 -0500
@@ -26,7 +26,7 @@
 endif
 
 libmathview_backend_gtk_la_CPPFLAGS = -DGMV_BackEnd_DLL
-libmathview_backend_gtk_la_LDFLAGS = -version-info @MATHVIEW_VERSION_INFO@
+libmathview_backend_gtk_la_LDFLAGS = -version-info @MATHVIEW_VERSION_INFO@ -no-undefined
 
 libmathview_backend_gtk_la_SOURCES = \
   Gtk_AdobeShaper.cc \
@@ -76,6 +76,7 @@
 #   Gtk_XftGlyphArea.hh
 
 libmathview_backend_gtk_la_LIBADD = \
+  $(top_builddir)/src/libmathview.la \
   $(PANGOX_LIBS) \
   $(GTK_LIBS) \
   $(T1_LIBS) \
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x aclocal.m4 -x Makefile.in -x configure -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in origsrc/gtkmathview-0.8.0/src/backend/ps/Makefile.am src/gtkmathview-0.8.0/src/backend/ps/Makefile.am
--- origsrc/gtkmathview-0.8.0/src/backend/ps/Makefile.am	2007-08-17 05:02:40.000000000 -0500
+++ src/gtkmathview-0.8.0/src/backend/ps/Makefile.am	2008-07-01 12:23:11.468750000 -0500
@@ -34,7 +34,7 @@
 endif
 
 libmathview_backend_ps_la_CPPFLAGS = -DGMV_BackEnd_DLL
-libmathview_backend_ps_la_LDFLAGS = -version-info @MATHVIEW_VERSION_INFO@
+libmathview_backend_ps_la_LDFLAGS = -version-info @MATHVIEW_VERSION_INFO@ -no-undefined
 
 libmathview_backend_ps_la_SOURCES = \
   PS_AreaFactory.hh \
@@ -61,6 +61,10 @@
   $(MAYBE_T1LIB_H) \
   $(NULL)
 
+libmathview_backend_ps_la_LIBADD = \
+  $(top_builddir)/src/libmathview.la \
+  $(T1_LIBS)
+
 mathviewdir = $(pkgincludedir)/MathView
 mathview_HEADERS = \
   PS_Backend.hh \
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x aclocal.m4 -x Makefile.in -x configure -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in origsrc/gtkmathview-0.8.0/src/backend/svg/Makefile.am src/gtkmathview-0.8.0/src/backend/svg/Makefile.am
--- origsrc/gtkmathview-0.8.0/src/backend/svg/Makefile.am	2007-04-25 03:14:33.000000000 -0500
+++ src/gtkmathview-0.8.0/src/backend/svg/Makefile.am	2008-07-01 12:23:11.484375000 -0500
@@ -29,7 +29,7 @@
 endif
 
 libmathview_backend_svg_la_CPPFLAGS = -DGMV_BackEnd_DLL
-libmathview_backend_svg_la_LDFLAGS = -version-info @MATHVIEW_VERSION_INFO@
+libmathview_backend_svg_la_LDFLAGS = -version-info @MATHVIEW_VERSION_INFO@ -no-undefined
 
 libmathview_backend_svg_la_SOURCES = \
   SVG_AreaFactory.hh \
@@ -56,6 +56,9 @@
   $(MAYBE_TFM_H) \
   $(NULL)
 
+libmathview_backend_svg_la_LIBADD = \
+  $(top_builddir)/src/libmathview.la
+
 mathviewdir = $(pkgincludedir)/MathView
 mathview_HEADERS = \
   SVG_Backend.hh \
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x aclocal.m4 -x Makefile.in -x configure -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in origsrc/gtkmathview-0.8.0/src/widget/Makefile.am src/gtkmathview-0.8.0/src/widget/Makefile.am
--- origsrc/gtkmathview-0.8.0/src/widget/Makefile.am	2007-08-17 05:02:35.000000000 -0500
+++ src/gtkmathview-0.8.0/src/widget/Makefile.am	2008-07-01 12:23:11.921875000 -0500
@@ -37,6 +37,7 @@
   $(T1_LIBS_X) \
   $(top_builddir)/src/backend/gtk/libmathview_backend_gtk.la \
   $(top_builddir)/src/view/libmathview_frontend_custom_reader.la \
+  $(top_builddir)/src/libmathview.la \
   $(NULL)
 
 libgtkmathview_libxml2_reader_la_LIBADD = \
@@ -45,6 +46,7 @@
   $(T1_LIBS_X) \
   $(top_builddir)/src/backend/gtk/libmathview_backend_gtk.la \
   $(top_builddir)/src/view/libmathview_frontend_libxml2_reader.la \
+  $(top_builddir)/src/libmathview.la \
   $(NULL)
 
 libgtkmathview_libxml2_la_LIBADD = \
@@ -53,20 +55,23 @@
   $(T1_LIBS_X) \
   $(top_builddir)/src/backend/gtk/libmathview_backend_gtk.la \
   $(top_builddir)/src/view/libmathview_frontend_libxml2.la \
+  $(top_builddir)/src/libmathview.la \
   $(NULL)
 
 libgtkmathview_gmetadom_la_LIBADD = \
   $(GTK_LIBS) \
+  $(DOM_LIBS) \
   $(T1_LIBS) \
   $(T1_LIBS_X) \
   $(top_builddir)/src/backend/gtk/libmathview_backend_gtk.la \
   $(top_builddir)/src/view/libmathview_frontend_gmetadom.la \
+  $(top_builddir)/src/libmathview.la \
   $(NULL)
 
-libgtkmathview_custom_reader_la_LDFLAGS = -version-info @MATHVIEW_VERSION_INFO@
-libgtkmathview_libxml2_reader_la_LDFLAGS = -version-info @MATHVIEW_VERSION_INFO@
-libgtkmathview_libxml2_la_LDFLAGS = -version-info @MATHVIEW_VERSION_INFO@
-libgtkmathview_gmetadom_la_LDFLAGS = -version-info @MATHVIEW_VERSION_INFO@
+libgtkmathview_custom_reader_la_LDFLAGS = -version-info @MATHVIEW_VERSION_INFO@ -no-undefined
+libgtkmathview_libxml2_reader_la_LDFLAGS = -version-info @MATHVIEW_VERSION_INFO@ -no-undefined
+libgtkmathview_libxml2_la_LDFLAGS = -version-info @MATHVIEW_VERSION_INFO@ -no-undefined
+libgtkmathview_gmetadom_la_LDFLAGS = -version-info @MATHVIEW_VERSION_INFO@ -no-undefined
 
 libgtkmathview_custom_reader_la_SOURCES = gtkmathview_custom_reader.cc
 libgtkmathview_libxml2_reader_la_SOURCES = gtkmathview_libxml2_reader.cc
